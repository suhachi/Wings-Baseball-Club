# P2. IA/라우팅 리셋 작업 완료 보고서

## 작업 개요

**작업 기간**: μATOM-0201 ~ μATOM-0205  
**목적**: v1.1 범위에 맞게 IA(Information Architecture)와 라우팅을 재구성하고, 게시판 탭을 공지/자유/연습·시합 3개로 고정  
**결과**: 모든 IA/라우팅 리셋 완료, 빌드 통과 확인

---

## 완료된 μATOM 목록

### ✅ μATOM-0201: Bottom Tabs를 홈/게시판/내정보 3개로 고정

**작업 내용:**
- `src/app/components/BottomNav.tsx`에서 `schedule` 탭 제거
- 탭을 `home`, `boards`, `my` 3개로 고정
- `Calendar` 아이콘 import 제거
- `activeTab` 및 `onTabChange` 타입을 `'home' | 'boards' | 'my'`로 수정

**수정된 파일:**
- `src/app/components/BottomNav.tsx`

**검증:**
- ✅ 탭 3개만 렌더링됨
- ✅ 제거된 탭(schedule) 라우팅 분기 없음
- ✅ 빌드 통과

---

### ✅ μATOM-0202: 게시판 탭을 공지/자유/연습·시합 3개로 고정

**작업 내용:**
- `src/app/pages/BoardsPage.tsx`에서 `meetup` 탭을 `event`로 변경
- 탭 레이블을 "기타"에서 "연습·시합"으로 변경
- 아이콘을 `Users`에서 `Calendar`로 변경
- 필터링 로직을 `meetupPosts`에서 `eventPosts`로 변경
- `src/lib/firebase/types.ts`에서 `PostType`에서 `'meetup'` 제거

**수정된 파일:**
- `src/app/pages/BoardsPage.tsx`
- `src/lib/firebase/types.ts`

**검증:**
- ✅ 기타/투표/경기 탭 0건
- ✅ 쿼리 필터 `type=notice/free/event`만 사용
- ✅ 빌드 통과

---

### ✅ μATOM-0203: 글쓰기 버튼 노출 조건만 UI에 반영

**작업 내용:**
- `src/app/pages/BoardsPage.tsx`에 `activeTab` state 추가
- `Tabs` 컴포넌트에 `value`와 `onValueChange` prop 추가
- FAB(글쓰기 버튼) 노출 조건 수정:
  - **공지/연습·시합 탭**: `isAdmin() && user?.status === 'active'`일 때만 노출
  - **자유 탭**: `user?.status === 'active'`일 때만 노출
- 버튼 클릭 시 현재 탭에 맞는 타입으로 게시글 생성 모달 열기

**수정된 파일:**
- `src/app/pages/BoardsPage.tsx`

**검증:**
- ✅ 공지/연습·시합: adminLike만 버튼 노출
- ✅ 자유: 멤버면 노출
- ✅ 권한 강제는 Functions/Rules에서 처리 (UI는 표시만)

---

### ✅ μATOM-0204: 라우트 정리(삭제된 페이지 라우트 제거)

**작업 내용:**
- `src/app/App.tsx`에서 `SchedulePage` import 제거
- `PageType`에서 `'schedule'` 제거
- `activeTab` 타입에서 `'schedule'` 제거
- `handleNavigate` 함수 타입에서 `'schedule'` 제거
- `currentPage === 'schedule'` 라우팅 분기 제거
- `src/app/pages/HomePage.tsx`에서 `schedule` 네비게이션을 `boards`로 변경
- `src/app/pages/MyPage.tsx`에서 `onNavigateToScheduleManage` prop 제거
- `EventCard` 컴포넌트의 `onNavigate` 타입에서 `'schedule'` 제거

**수정된 파일:**
- `src/app/App.tsx`
- `src/app/pages/HomePage.tsx`
- `src/app/pages/MyPage.tsx`

**검증:**
- ✅ 직접 URL/상태 전환으로도 제외 페이지(schedule) 진입 불가
- ✅ 모든 schedule 관련 라우팅 제거됨
- ✅ 빌드 통과

---

### ✅ μATOM-0205: 공통 레이아웃 기준 정리(TopBar/Back/Container)

**작업 내용:**
- `src/app/components/TopBar.tsx` 확인: 이미 공통 레이아웃으로 잘 구성됨
- `src/app/App.tsx`의 `getPageConfig` 함수 확인: 각 페이지별 제목/뒤로가기 설정 정상
- 모든 페이지가 `pb-20 pt-16` 클래스를 사용하여 BottomNav/TopBar와 일관된 레이아웃 유지

**확인된 공통 레이아웃:**
- **TopBar**: 고정 위치(`fixed top-0`), 모든 페이지에서 일관된 스타일
- **Back 버튼**: `showBack` prop으로 제어, 설정/알림/관리자 페이지에서만 표시
- **Container**: `max-w-md mx-auto`로 중앙 정렬, `pb-20 pt-16`으로 하단/상단 여백 확보

**검증:**
- ✅ 화면간 레이아웃 불일치 제거
- ✅ TopBar/Back/Container 일관성 유지
- ✅ 빌드 통과

---

## 수정된 파일 목록

### 주요 수정 파일 (총 7개)
1. `src/app/components/BottomNav.tsx` - schedule 탭 제거, 3개 탭으로 고정
2. `src/app/App.tsx` - schedule 라우팅 제거, PageType 수정
3. `src/app/pages/BoardsPage.tsx` - meetup을 event로 변경, 글쓰기 버튼 조건 추가
4. `src/app/pages/HomePage.tsx` - schedule 네비게이션을 boards로 변경
5. `src/app/pages/MyPage.tsx` - schedule 관련 prop 제거
6. `src/lib/firebase/types.ts` - PostType에서 meetup 제거

---

## 빌드 검증 결과

### Frontend 빌드
```bash
npm run build
```
**결과**: ✅ 성공
- 빌드 시간: 28.47s
- 출력 파일: `dist/index.html`, `dist/assets/*`
- 경고: chunk 크기 경고 (기능 영향 없음)

---

## Done 체크리스트

- [x] μATOM-0201: 탭 3개만 렌더, 제거된 탭 라우팅 분기 없음
- [x] μATOM-0202: 기타/투표/경기 탭 0, 쿼리 필터 type=notice/free/event만 사용
- [x] μATOM-0203: 공지/연습·시합 adminLike만 버튼 노출, 자유 멤버면 노출
- [x] μATOM-0204: 직접 URL/상태 전환으로도 제외 페이지 진입 불가
- [x] μATOM-0205: 화면간 레이아웃 불일치 제거

---

## 변경 사항 요약

### BottomNav
- **이전**: home, schedule, boards, my (4개)
- **이후**: home, boards, my (3개)

### BoardsPage 탭
- **이전**: notice, free, meetup (3개, meetup 사용)
- **이후**: notice, free, event (3개, event 사용)

### 글쓰기 버튼 노출 조건
- **공지/연습·시합 탭**: 관리자만 표시
- **자유 탭**: 활성 멤버면 표시

### 라우팅
- **제거된 라우트**: `schedule`
- **유지된 라우트**: `home`, `boards`, `my`, `settings`, `notifications`, `admin`, `my-activity`, `install`

---

## 다음 단계

P2 단계가 완료되었습니다. 다음 단계는 **P3: posts 타입 재정의 및 UI/쿼리 정합화** (μATOM-R03)입니다.

**예상 작업:**
- posts.type을 notice/free/event 3종으로 고정
- 리스트/상세/작성 플로우 정합화
- 각 탭이 type 필터로 정확히 동작하는지 확인

---

## 보완 작업

검수 결과에 따라 `meetup` → `event` 마이그레이션 보완 작업을 완료했습니다. 자세한 내용은 `P2_보완작업완료보고서.md`를 참조하세요.

**최종 판정**: ✅ **PASS (마이그레이션 보완 완료)**

---

## 작업 완료 일시

**완료 시간**: 2024년 작업 완료  
**보완 완료 시간**: 2024년 검수 후 보완 완료  
**작업자**: AI Assistant  
**검증 상태**: ✅ 빌드 통과, 모든 체크리스트 완료, `meetup` 키워드 0건 확인

