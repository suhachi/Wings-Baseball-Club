# μATOM-0006 작업 완료 보고서

**작업 완료 일시**: 2024년 (현재)  
**작업 범위**: R01 삭제 타겟 "정확 지정 리스트" 확정  
**작업 방식**: READ-ONLY (코드 변경 없음)  
**근거**: μATOM-0002~0005 리포트 기반, 파일 경로, 라인 번호

---

## 작업 완료 요약

### ✅ 완료된 작업

**산출물**: `μATOM-0006_DELETE_TARGET_LIST.md`

**작업 내용**:
1. 프론트 페이지/컴포넌트/라우팅 분기 삭제 대상 정리 (8개 파일, 27곳 코드 수정)
2. services/lib 타입/쿼리 삭제 대상 정리 (types.ts, firestore.service.ts, DataContext.tsx)
3. functions callables/scheduled/export 삭제 대상 정리 (4개 파일)
4. rules match/allow 삭제 대상 정리 (9곳)
5. 문서/가이드 처리 방안 정리 (유지 권장)
6. P1 각 μATOM에 1:1 작업 항목 분배 완료
7. "삭제 후 빌드 통과" 리스크 포인트 사전 표기

---

## 핵심 산출물

### (A) 프론트 페이지/컴포넌트/라우팅 분기

**파일 제거**: 8개
- `AlbumPage.tsx`, `FinancePage.tsx`, `GameRecordPage.tsx`, `ApprovalPendingPage.tsx`
- `PollVoteModal.tsx`
- `game-record/BatterTable.tsx`, `game-record/PitcherTable.tsx`, `game-record/LineupEditor.tsx`

**코드 수정**: 5개 파일, 27곳
- `App.tsx`: 8곳
- `BottomNav.tsx`: 3곳
- `BoardsPage.tsx`: 10곳 이상
- `MyPage.tsx`: 4곳
- `HomePage.tsx`: 2곳

### (B) services/lib 타입/쿼리

**타입 제거**:
- `PostType`: `'poll'`, `'game'`, `'album'` 제거, `'meetup'` → `'event'` 변경
- `GameType`, `MediaType` 제거
- `FinanceDoc`, `LineupDoc`, `BatterRecordDoc`, `PitcherRecordDoc` 제거
- `PostDoc` 인터페이스에서 Poll/Game/Album 필드 제거

**함수 제거**:
- `firestore.service.ts`: `addFinance`, `getFinances`, `deleteFinance` (3개)
- `firestore.service.ts`: 게임 기록 관련 함수 6개
- `DataContext.tsx`: `votePoll` 함수 제거

### (C) functions callables/scheduled/export

**파일 제거**: 4개
- `functions/src/callables/polls.ts`
- `functions/src/callables/dues.ts`
- `functions/src/callables/ledger.ts`
- `functions/src/callables/games.ts`

**Export 확인**: `functions/src/index.ts` 이미 주석 처리됨

### (D) rules match/allow

**Rules 수정**: 9곳
- `inviteCodes` match 블록 (선택사항)
- `poll`, `game` 타입 참조 제거
- `meetup` → `event` 변경
- `recordingLocked` 필드 참조 제거
- `/votes/{userId}` match 블록 제거
- `/record_*` match 블록 제거 (3개)
- `canRecordAdminOverride()` 함수 제거
- `dues`, `ledger` match 블록 (선택사항)

### (E) 문서/가이드

**권장 조치**: 유지 (과거 기록/스냅샷으로 보존)

---

## P1 μATOM-0101~0110 작업 항목 분배

| μATOM | 제목 | 파일 제거 | 코드 수정 | Rules 수정 | 상태 |
|-------|------|----------|----------|-----------|------|
| **μATOM-0101** | Invite/초대 도메인 제거 | 0개 | 0곳 | 1곳 (선택) | ✅ 준비 완료 |
| **μATOM-0102** | 회원가입/가입승인 UI/Flow 제거 | 1개 | 0곳 | 0곳 | ✅ 준비 완료 |
| **μATOM-0103** | 경기 기록 제거 | 4개 | 다수 | 4곳 | ✅ 준비 완료 |
| **μATOM-0104** | 회비/회계 제거 | 3개 | 다수 | 2곳 (선택) | ✅ 준비 완료 |
| **μATOM-0105** | 앨범 제거 | 1-2개 | 다수 | 0곳 | ✅ 준비 완료 |
| **μATOM-0106** | 의제 투표 게시판 제거 | 1개 | 다수 | 2곳 | ✅ 준비 완료 |
| **μATOM-0107** | Rules에서 제외 도메인 match 제거 | 0개 | 0곳 | 9곳 | ✅ 준비 완료 |
| **μATOM-0108** | Functions export에서 제외 도메인 제거 | 4개 | 0곳 | 0곳 | ✅ 준비 완료 |
| **μATOM-0109** | UI 진입 경로에서 제외 도메인 링크 제거 | 0개 | 27곳 | 0곳 | ✅ 준비 완료 |
| **μATOM-0110** | "dead code" 잔존 여부 최종 확인 | 0개 | 0곳 | 0곳 | ✅ 준비 완료 |

---

## "삭제 후 빌드 통과" 리스크 포인트

### 🔴 HIGH 리스크 (즉시 대응 필요)

1. **타입 불일치 (PostType)**
   - **위치**: `src/lib/firebase/types.ts` 라인 4
   - **리스크**: `PostType`에서 `'poll'`, `'game'`, `'album'` 제거 시 타입 에러
   - **대응**: 모든 파일에서 해당 타입 참조 제거 확인

2. **함수 시그니처 불일치 (votePoll)**
   - **위치**: `src/app/contexts/DataContext.tsx`
   - **리스크**: `votePoll` 함수 제거 시 호출 코드 에러
   - **대응**: `rg -n "votePoll\(" src` → 0건 확인

3. **Rules 파싱 실패**
   - **위치**: `firestore.rules`
   - **리스크**: match 블록 제거 시 문법 오류
   - **대응**: `firebase emulators:start --only firestore` 실행

4. **Import 에러**
   - **위치**: `src/app/App.tsx` 등
   - **리스크**: 파일 제거 후 import 문 남아있으면 컴파일 에러
   - **대응**: 모든 import 문 제거 확인

### 🟡 MEDIUM 리스크 (주의 필요)

5. **타입 변환 로직 누락**
   - **위치**: `src/app/contexts/DataContext.tsx`
   - **리스크**: Poll/Game/Album 필드 변환 로직 제거 누락
   - **대응**: 해당 필드 접근 코드 모두 제거 확인

6. **조건문 분기 누락**
   - **위치**: `src/app/App.tsx` 라인 109
   - **리스크**: `handlePageChange`에서 제외 타입 조건 제거 누락
   - **대응**: 모든 조건문에서 제외 타입 제거 확인

7. **FileUploadModal 재사용 가능성**
   - **위치**: `src/app/components/FileUploadModal.tsx`
   - **리스크**: 앨범 외 다른 용도로 사용 가능
   - **대응**: `rg -n "FileUploadModal" src` → 사용처 확인

### 🟢 LOW 리스크 (영향 적음)

8. **주석/문서 참조**
   - **위치**: `docs/` 디렉토리
   - **리스크**: 문서에 제외 키워드 남아있음 (기능 영향 없음)
   - **대응**: 문서는 유지

9. **빈 파일 제거**
   - **위치**: `functions/src/callables/polls.ts` 등
   - **리스크**: 낮음 (빈 파일이므로 제거 안전)
   - **대응**: `functions/src/index.ts`에서 export 확인

---

## 검증 커맨드 (P1 완료 후)

### 기본 검증
```bash
# 빌드 검증
npm run build
npm run type-check
cd functions && npm run build
```

### 제외 키워드 재검색
```bash
rg -n "(invite|approval|signup|record|recorder|lock|dues|ledger|poll|album)" -S src functions firestore.rules || echo "0 matches"
```

### 제외 파일 존재 확인
```bash
test -f src/app/pages/AlbumPage.tsx && echo "EXISTS" || echo "NOT FOUND"
test -f src/app/pages/FinancePage.tsx && echo "EXISTS" || echo "NOT FOUND"
test -f src/app/pages/GameRecordPage.tsx && echo "EXISTS" || echo "NOT FOUND"
test -f src/app/components/PollVoteModal.tsx && echo "EXISTS" || echo "NOT FOUND"
test -f functions/src/callables/polls.ts && echo "EXISTS" || echo "NOT FOUND"
test -f functions/src/callables/dues.ts && echo "EXISTS" || echo "NOT FOUND"
test -f functions/src/callables/ledger.ts && echo "EXISTS" || echo "NOT FOUND"
test -f functions/src/callables/games.ts && echo "EXISTS" || echo "NOT FOUND"
```

### Rules 파싱 검증
```bash
firebase emulators:start --only firestore
# (Ctrl+C로 종료 후 Rules 파싱 성공 확인)
```

---

## 통계 요약

### 파일 제거 대상
- **프론트엔드**: 8개 파일
- **Functions**: 4개 파일
- **총계**: 12개 파일

### 코드 수정 대상
- **파일 수**: 8개 파일
- **수정 위치**: 약 50곳 이상
- **주요 파일**: `App.tsx`, `BoardsPage.tsx`, `DataContext.tsx`, `types.ts`, `firestore.service.ts`

### Rules 수정 대상
- **수정 위치**: 9곳
- **주요 내용**: match 블록 제거, 타입 참조 제거, 함수 제거

---

## Done 체크리스트

- [x] P1 각 μATOM에 1:1로 작업 항목 분배 완료
- [x] "삭제 후 빌드 통과" 리스크 포인트 사전 표기
- [x] 파일 제거 대상 정확 목록 (12개)
- [x] 코드 수정 대상 정확 목록 (파일별 라인 번호 포함)
- [x] Rules 수정 대상 정확 목록 (라인 번호 포함)
- [x] 검증 커맨드 정확 명시
- [x] μATOM-0101~0110 작업 항목 매핑 완료

---

## 다음 단계

**P1: 제외 범위 물리 제거 (μATOM-0101~0110)**

작업 순서 (권장):
1. μATOM-0101: Invite/초대 도메인 제거 (Rules 정리)
2. μATOM-0102: 회원가입/가입승인 UI/Flow 제거
3. μATOM-0108: Functions export에서 제외 도메인 제거 (빈 파일 제거)
4. μATOM-0103: 경기 기록 제거
5. μATOM-0104: 회비/회계 제거
6. μATOM-0105: 앨범 제거
7. μATOM-0106: 의제 투표 게시판 제거
8. μATOM-0107: Rules에서 제외 도메인 match 제거
9. μATOM-0109: UI 진입 경로에서 제외 도메인 링크 제거
10. μATOM-0110: "dead code" 잔존 여부 최종 확인

**주의**: 각 μATOM 완료 후 빌드/타입체크 검증 필수

---

**작업 완료일**: 2024년 (현재)  
**작업자**: AI Assistant (Cursor)  
**검수 준비**: 완료 (안티그래비티/코파일럿 검수 가능)

**작업 방식**: READ-ONLY (코드 변경 없음, 증거 수집만)  
**근거**: 모든 발견 사항에 파일 경로/라인 번호/명령 결과 포함

