# P1. 제외 범위 물리 제거 작업 완료 보고서

## 작업 개요

**작업 기간**: μATOM-0101 ~ μATOM-0110  
**목적**: v1.1에서 제외된 도메인(Invite, Signup/Approval, Game Records, Dues/Ledger, Album, Poll)의 모든 코드, 참조, 규칙을 물리적으로 제거  
**결과**: 모든 제외 도메인 관련 코드 제거 완료, 빌드 통과 확인

---

## 완료된 μATOM 목록

### ✅ μATOM-0101: Invite/초대 도메인 제거
**제거된 항목:**
- `functions/src/callables/invites.ts` 파일 삭제
- `firestore.rules`에서 `match /inviteCodes/{code}` 블록 제거
- `src/app/pages/AdminPage.tsx`에서 "초대 코드" stat card 제거
- `functions/src/shared/paths.ts`에서 `inviteCol` 함수 제거
- `src/app/contexts/AuthContext.tsx`, `src/lib/firebase/auth.service.ts`에서 invite 관련 주석 제거

**검증:**
- `rg -n "invite|inviteCodes" -S src functions firestore.rules`: 0건 (문서 제외)

---

### ✅ μATOM-0102: 회원가입/가입승인 UI/Flow 제거
**제거된 항목:**
- `src/app/pages/ApprovalPendingPage.tsx` 파일 삭제
- `src/app/components/ApprovalPendingCard.tsx` 파일 삭제
- `src/app/contexts/AuthContext.tsx`에서 signup/approval 관련 주석 정리

**검증:**
- `rg -n "approval|pending|signup" -S src functions firestore.rules`: 0건 (문서/주석 제외)

---

### ✅ μATOM-0103: 경기 기록(record/LOCK/기록원) 제거
**제거된 항목:**
- `src/app/pages/GameRecordPage.tsx` 파일 삭제
- `src/app/components/game-record/BatterTable.tsx` 파일 삭제
- `src/app/components/game-record/PitcherTable.tsx` 파일 삭제
- `src/app/components/game-record/LineupEditor.tsx` 파일 삭제
- `functions/src/callables/games.ts` 파일 삭제
- `src/app/pages/MyPage.tsx`에서 게임 기록 관리 링크 제거
- `src/lib/firebase/types.ts`에서 `GameType`, `LineupDoc`, `BatterRecordDoc`, `PitcherRecordDoc` 제거
- `src/lib/firebase/firestore.service.ts`에서 게임 기록 관련 함수 제거
- `src/app/contexts/DataContext.tsx`에서 게임 기록 관련 필드 및 로직 제거
- `src/app/pages/SchedulePage.tsx`에서 `recorders` 관련 코드 제거

**검증:**
- `rg -n "record_|recorders|recordingLocked|LOCK" -S src functions firestore.rules`: 0건 (문서 제외)

---

### ✅ μATOM-0104: 회비/회계(dues/ledger) 제거
**제거된 항목:**
- `src/app/pages/FinancePage.tsx` 파일 삭제
- `functions/src/callables/dues.ts` 파일 삭제
- `functions/src/callables/ledger.ts` 파일 삭제
- `src/app/pages/MyPage.tsx`에서 회비/회계 메뉴 제거
- `src/lib/firebase/types.ts`에서 `FinanceDoc` 제거
- `src/lib/firebase/firestore.service.ts`에서 finance 관련 함수 제거
- `functions/src/shared/paths.ts`에서 `duesRef`, `duesCol`, `ledgerRef`, `ledgerCol` 함수 제거

**검증:**
- `rg -n "dues|ledger|finance" -S src functions firestore.rules`: 0건 (문서 제외)

---

### ✅ μATOM-0105: 앨범(album/photo/video) 제거
**제거된 항목:**
- `src/app/pages/AlbumPage.tsx` 파일 삭제
- `src/app/App.tsx`에서 AlbumPage import 및 라우팅 제거
- `src/app/components/BottomNav.tsx`에서 'album' 탭 제거
- `src/app/pages/HomePage.tsx`에서 "사진올리기" 버튼의 album 네비게이션 제거
- `src/lib/firebase/types.ts`에서 `MediaType` 및 앨범 관련 필드 제거
- `src/lib/firebase/storage.service.ts`에서 `uploadAlbumMedia` 함수 제거
- `src/app/contexts/DataContext.tsx`에서 앨범 관련 필드 제거
- `src/app/components/FileUploadModal.tsx`에서 앨범 관련 로직 제거

**검증:**
- `rg -n "album|mediaUrls|mediaType|photo|video" -S src functions firestore.rules`: 0건 (문서 제외)

---

### ✅ μATOM-0106: 의제 투표 게시판(poll) 제거
**제거된 항목:**
- `src/app/components/PollVoteModal.tsx` 파일 삭제
- `functions/src/callables/polls.ts` 파일 삭제
- `src/app/pages/BoardsPage.tsx`에서 poll/game 탭 및 관련 UI 제거
- `src/lib/firebase/types.ts`에서 `PostType`에서 'poll', 'game' 제거 및 poll 관련 필드 제거
- `src/app/contexts/DataContext.tsx`에서 `votePoll`, `getMyVote` 함수 및 poll 관련 필드 제거

**검증:**
- `rg -n "\\bpoll\\b|choices\\b|PollVoteModal" -S src functions firestore.rules`: 0건 (문서 제외)

---

### ✅ μATOM-0107: Rules에서 제외 도메인 match/허용 제거
**확인 결과:**
- `firestore.rules`에 제외 도메인(poll, game, album, dues, ledger, invite) 관련 match 블록 없음
- `votes` 서브컬렉션 규칙 없음 (poll 제외에 따라)
- `record_*` 서브컬렉션 규칙 없음 (game record 제외에 따라)

**검증:**
- `rg -n "poll|game|album|dues|ledger|invite|votes|record_" -i firestore.rules`: 0건

---

### ✅ μATOM-0108: Functions export에서 제외 도메인 엔드포인트 제거
**확인 결과:**
- `functions/src/index.ts`에서 제외 도메인 export 없음
- `functions/src/callables/` 디렉토리에 제외 도메인 파일 없음:
  - ✅ `invites.ts` 삭제됨
  - ✅ `polls.ts` 삭제됨
  - ✅ `dues.ts` 삭제됨
  - ✅ `ledger.ts` 삭제됨
  - ✅ `games.ts` 삭제됨

**검증:**
- `rg -n "export.*from.*callables/(invites|polls|dues|ledger|games)" functions/src/index.ts`: 0건

---

### ✅ μATOM-0109: UI 진입 경로/메뉴/탭에서 제외 도메인 링크 제거
**제거된 항목:**
- `src/app/App.tsx`에서 AlbumPage, FinancePage, GameRecordPage import 및 라우팅 제거
- `src/app/components/BottomNav.tsx`에서 'album' 탭 제거
- `src/app/pages/HomePage.tsx`에서 album 네비게이션 제거
- `src/app/pages/MyPage.tsx`에서 finance, game-record 네비게이션 제거
- `src/app/pages/AdminPage.tsx`에서 "Pending Approvals" 섹션 및 `approveMember`, `rejectMember` 함수 제거

**검증:**
- `rg -n "AlbumPage|FinancePage|GameRecordPage|PollVoteModal|ApprovalPendingPage" src/app`: 0건

---

### ✅ μATOM-0110: dead code 잔존 여부 최종 grep 0건 확인
**최종 검증 결과:**

**src 디렉토리:**
- `rg -n "(invite|approval|signup|record_|recorders|recordingLocked|dues|ledger|\\bpoll\\b|album)" -S src`: 
  - `src/app/contexts/AuthContext.tsx`: 주석에 "signup" 언급 (문서용, 허용)
  - 총 1건 (문서/주석만)

**functions/src 디렉토리:**
- `rg -n "(invite|approval|signup|record_|recorders|recordingLocked|dues|ledger|\\bpoll\\b|album)" -S functions/src`:
  - `functions/src/shared/audit.ts`, `idempotency.ts`, `errors.ts`: 문서/주석에만 언급 (허용)
  - 총 3건 (문서/주석만)

**firestore.rules:**
- 제외 키워드 0건

**결론:** 코드 영역에서 제외 키워드 0건 (문서/주석 제외)

---

## 빌드 검증 결과

### Frontend 빌드
```bash
npm run build
```
**결과**: ✅ 성공
- 빌드 시간: 10.57s
- 출력 파일: `dist/index.html`, `dist/assets/*`
- 경고: chunk 크기 경고 (기능 영향 없음)

### Functions 빌드
```bash
cd functions && npm run build
```
**결과**: ✅ 성공
- TypeScript 컴파일 완료
- 에러 없음

---

## 제거된 파일 목록

### 삭제된 파일 (총 11개)
1. `functions/src/callables/invites.ts`
2. `src/app/pages/ApprovalPendingPage.tsx`
3. `src/app/components/ApprovalPendingCard.tsx`
4. `src/app/pages/GameRecordPage.tsx`
5. `src/app/components/game-record/BatterTable.tsx`
6. `src/app/components/game-record/PitcherTable.tsx`
7. `src/app/components/game-record/LineupEditor.tsx`
8. `functions/src/callables/games.ts`
9. `src/app/pages/FinancePage.tsx`
10. `functions/src/callables/dues.ts`
11. `functions/src/callables/ledger.ts`
12. `src/app/pages/AlbumPage.tsx`
13. `src/app/components/PollVoteModal.tsx`
14. `functions/src/callables/polls.ts`

---

## 수정된 파일 목록

### 주요 수정 파일 (총 20개)
1. `firestore.rules` - inviteCodes match 블록 제거
2. `src/app/contexts/AuthContext.tsx` - invite/signup 관련 주석 정리
3. `src/lib/firebase/auth.service.ts` - invite 관련 주석 제거
4. `src/app/pages/AdminPage.tsx` - 초대 코드 stat, 승인 섹션 제거
5. `functions/src/shared/paths.ts` - inviteCol, record_*, dues, ledger 함수 제거
6. `src/app/App.tsx` - 제외 도메인 페이지 라우팅 제거
7. `src/app/components/BottomNav.tsx` - album 탭 제거
8. `src/app/pages/HomePage.tsx` - album 네비게이션 제거
9. `src/app/pages/MyPage.tsx` - finance, game-record 네비게이션 제거
10. `src/app/pages/BoardsPage.tsx` - poll/game 탭 및 UI 제거
11. `src/lib/firebase/types.ts` - 제외 도메인 타입 제거
12. `src/lib/firebase/firestore.service.ts` - 제외 도메인 함수 제거
13. `src/app/contexts/DataContext.tsx` - 제외 도메인 필드 및 함수 제거
14. `src/lib/firebase/storage.service.ts` - uploadAlbumMedia 제거
15. `src/app/components/FileUploadModal.tsx` - 앨범 관련 로직 제거
16. `src/app/pages/SchedulePage.tsx` - recorders 관련 코드 제거
17. `functions/src/index.ts` - 제외 도메인 export 제거 (이미 완료)

---

## Done 체크리스트

- [x] μATOM-0101: invite 키워드(코드 영역) 0건
- [x] μATOM-0102: ApprovalPendingPage/승인 UI 진입 경로 0
- [x] μATOM-0103: GameRecordPage 및 관련 컴포넌트 참조 0
- [x] μATOM-0104: FinancePage/재무 메뉴/총무 role 의존 제거
- [x] μATOM-0105: 앨범 탭/페이지/작성 플로우 0
- [x] μATOM-0106: poll 관련 컴포넌트/탭/타입 0
- [x] μATOM-0107: 제외 도메인 write 허용 0, v1.1 컬렉션만 남음
- [x] μATOM-0108: index.ts 기준 제외 도메인 export 0
- [x] μATOM-0109: 앱에서 제외 도메인으로 들어갈 경로 0
- [x] μATOM-0110: 코드 기준 제외 키워드 0건(또는 docs/legacy만 남김을 명시)

---

## 다음 단계

P1 단계가 완료되었습니다. 다음 단계는 **P2: v1.1 IA 재구성(탭/라우팅/메뉴)** (μATOM-R02)입니다.

**예상 작업:**
- BottomTab을 홈/게시판/내정보로 단순화
- 게시판 탭을 공지/자유/연습·시합 3개만 남김
- 데이터 타입/쿼리 정리

---

## 작업 완료 일시

**완료 시간**: 2024년 작업 완료  
**작업자**: AI Assistant  
**검증 상태**: ✅ 빌드 통과, grep 0건 확인

