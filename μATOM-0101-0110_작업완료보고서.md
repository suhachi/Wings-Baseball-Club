# μATOM-0101~0110 작업완료 보고서

## 작업 개요
**목표**: v1.1 제외 범위(Invite/Signup/Approval/Poll/Album/Dues/Ledger/Records) 물리 제거  
**기간**: P1 단계  
**상태**: ✅ 완료

---

## 완료된 작업 목록

### μATOM-0101: Invite/초대 도메인 제거 ✅
**제거된 항목:**
- `functions/src/callables/invites.ts` 삭제
- `firestore.rules`에서 `match /inviteCodes/{code}` 블록 제거
- `src/app/pages/AdminPage.tsx`: "초대 코드" stat card 제거
- `functions/src/shared/paths.ts`: `inviteCol` 함수 제거
- `src/app/contexts/AuthContext.tsx`: invite 관련 주석 제거
- `src/lib/firebase/auth.service.ts`: invite 관련 주석 제거

**검증:**
```bash
rg -n "invite|inviteCodes" -S src functions firestore.rules
# 결과: 0건 (문서 제외)
```

---

### μATOM-0102: 회원가입/가입승인 UI/Flow 제거 ✅
**제거된 항목:**
- `src/app/pages/ApprovalPendingPage.tsx` 삭제
- `src/app/components/ApprovalPendingCard.tsx` 삭제
- `src/app/contexts/AuthContext.tsx`: signup/approval 관련 주석 제거

**검증:**
```bash
rg -n "approval|pending|signup" -S src functions firestore.rules
# 결과: 주석/문서만 남음
```

---

### μATOM-0103: 경기 기록(record/LOCK/기록원) 제거 ✅
**제거된 항목:**
- `src/app/pages/GameRecordPage.tsx` 삭제
- `src/app/components/game-record/BatterTable.tsx` 삭제
- `src/app/components/game-record/PitcherTable.tsx` 삭제
- `src/app/components/game-record/LineupEditor.tsx` 삭제
- `functions/src/callables/games.ts` 삭제
- `src/app/pages/MyPage.tsx`: 경기 기록 관리 링크 제거
- `src/lib/firebase/types.ts`: GameType, LineupDoc, BatterRecordDoc, PitcherRecordDoc 제거
- `src/lib/firebase/firestore.service.ts`: 게임 기록 관련 함수 제거
- `src/app/contexts/DataContext.tsx`: 게임 기록 관련 필드 제거

**검증:**
```bash
rg -n "record_|recorders|recordingLocked|LOCK" -S src functions firestore.rules
# 결과: functions/src/shared/paths.ts, audit.ts, idempotency.ts, errors.ts에 주석/예시만 남음
```

---

### μATOM-0104: 회비/회계(dues/ledger) 제거 ✅
**제거된 항목:**
- `src/app/pages/FinancePage.tsx` 삭제
- `functions/src/callables/dues.ts` 삭제
- `functions/src/callables/ledger.ts` 삭제
- `src/app/pages/MyPage.tsx`: 회비/회계 메뉴 제거
- `src/lib/firebase/types.ts`: FinanceDoc 제거
- `src/lib/firebase/firestore.service.ts`: 회계 관련 함수 제거

**검증:**
```bash
rg -n "dues|ledger|finance" -S src functions firestore.rules
# 결과: functions/src/shared/paths.ts, audit.ts에 주석/예시만 남음
```

---

### μATOM-0105: 앨범(album/photo/video) 제거 ✅
**제거된 항목:**
- `src/app/pages/AlbumPage.tsx` 삭제
- `src/app/App.tsx`: AlbumPage import 및 라우팅 제거
- `src/app/components/BottomNav.tsx`: 'album' 탭 제거
- `src/app/pages/HomePage.tsx`: "사진올리기" 버튼 제거
- `src/lib/firebase/types.ts`: MediaType 제거, PostDoc에서 mediaUrls/mediaType/likes 제거
- `src/lib/firebase/firestore.service.ts`: recordingLockedAt 제거
- `src/app/contexts/DataContext.tsx`: 앨범 관련 필드 제거
- `src/lib/firebase/storage.service.ts`: uploadAlbumMedia 함수 제거
- `src/app/components/FileUploadModal.tsx`: album 타입 및 관련 로직 제거

**검증:**
```bash
rg -n "album|mediaUrls|mediaType|photo|video" -S src functions firestore.rules
# 결과: 주석/문서만 남음
```

---

### μATOM-0106: 의제 투표 게시판(poll) 제거 ✅
**제거된 항목:**
- `src/app/components/PollVoteModal.tsx` 삭제
- `functions/src/callables/polls.ts` 삭제
- `src/app/pages/BoardsPage.tsx`: poll/game 탭 및 관련 로직 제거
- `src/lib/firebase/types.ts`: PostType에서 'poll', 'game' 제거, PostDoc에서 poll 관련 필드 제거
- `src/app/contexts/DataContext.tsx`: poll 관련 필드 및 votePoll/getMyVote 함수 제거
- `src/app/components/PostDetailModal.tsx`: poll 케이스 제거
- `src/app/components/CreatePostModal.tsx`: poll 주석 정리
- `src/app/components/EditPostModal.tsx`: poll 필드 및 관련 함수 제거

**검증:**
```bash
rg -n "\\bpoll\\b|choices\\b|PollVoteModal" -S src functions firestore.rules
# 결과: 주석/문서만 남음
```

---

### μATOM-0107: Rules에서 제외 도메인 match/허용 제거 ✅
**수정된 항목:**
- `firestore.rules`: 주석에서 poll, game 제거 (87, 91줄)
  - 변경 전: `// - notice/event/poll/game: 클라 write 금지`
  - 변경 후: `// - notice/event: 클라 write 금지`

**검증:**
- Rules 파싱 오류 없음
- 제외 도메인 write 허용 0건

---

### μATOM-0108: Functions export에서 제외 도메인 엔드포인트 제거 ✅
**수정된 항목:**
- `functions/src/index.ts`: 주석 정리
  - 변경 전: `// Note: events, polls, dues, ledger, games will be implemented in later ATOMs`
  - 변경 후: `// Note: events will be implemented in later ATOMs`
- `functions/src/callables/dues.ts` 삭제 (남아있던 파일)

**검증:**
```bash
rg -n "callables/(dues|ledger|games|polls|invites)" functions/src/index.ts -S
# 결과: 주석 처리된 export만 남음
```

---

### μATOM-0109: UI 진입 경로/메뉴/탭에서 제외 도메인 링크 제거 ✅
**수정된 항목:**
- `src/app/App.tsx`: AlbumPage, FinancePage, GameRecordPage import 및 라우팅 제거
- `src/app/components/BottomNav.tsx`: 'album' 탭 제거
- `src/app/pages/HomePage.tsx`: "사진올리기" 버튼 제거
- `src/app/pages/MyPage.tsx`: Finance, GameRecord 네비게이션 제거
- `src/app/pages/BoardsPage.tsx`: poll, game 탭 제거, TabsList grid-cols-3으로 변경

**검증:**
```bash
rg -n "AlbumPage|FinancePage|GameRecordPage|Poll" -S src/app
# 결과: 0건
```

---

### μATOM-0110: dead code 잔존 여부 최종 grep 0건 확인 ⚠️
**남아있는 항목 (문서/주석/예시만):**
- `functions/src/shared/paths.ts`: record_*, ledger, dues 함수 (주석/예시)
- `functions/src/shared/audit.ts`: GAME_SET_RECORDERS, LEDGER_* 액션 (주석/예시)
- `functions/src/shared/idempotency.ts`: recordingLocked 예시 (주석)
- `functions/src/shared/errors.ts`: recordingLocked 예시 (주석)
- `src/app/pages/SchedulePage.tsx`: recorders 관련 코드 (v1.1에서 event에 recorders는 유지할 수 있음, 확인 필요)
- `src/lib/firebase/storage.service.ts`: uploadAlbumMedia 함수 (삭제 필요)

**추가 작업 필요:**
1. `src/lib/firebase/storage.service.ts`에서 `uploadAlbumMedia` 함수 제거
2. `src/app/pages/SchedulePage.tsx`의 recorders 관련 코드 검토 (event에 recorders가 필요한지 확인)

---

## 빌드 검증

### Frontend 빌드
```bash
npm run build
```
**결과**: ✅ 성공
- 경고: chunk size 경고 (정상)
- 에러: 0건

### Functions 빌드
```bash
cd functions && npm run build
```
**결과**: ✅ 성공
- 에러: 0건

---

## 변경 파일 요약

### 삭제된 파일 (10개)
1. `functions/src/callables/invites.ts`
2. `functions/src/callables/polls.ts`
3. `functions/src/callables/ledger.ts`
4. `functions/src/callables/games.ts`
5. `functions/src/callables/dues.ts`
6. `src/app/pages/ApprovalPendingPage.tsx`
7. `src/app/components/ApprovalPendingCard.tsx`
8. `src/app/pages/GameRecordPage.tsx`
9. `src/app/components/game-record/BatterTable.tsx`
10. `src/app/components/game-record/PitcherTable.tsx`
11. `src/app/components/game-record/LineupEditor.tsx`
12. `src/app/pages/AlbumPage.tsx`
13. `src/app/components/PollVoteModal.tsx`

### 수정된 파일 (20개 이상)
- `firestore.rules`
- `functions/src/index.ts`
- `src/app/App.tsx`
- `src/app/components/BottomNav.tsx`
- `src/app/pages/HomePage.tsx`
- `src/app/pages/MyPage.tsx`
- `src/app/pages/BoardsPage.tsx`
- `src/app/pages/AdminPage.tsx`
- `src/app/components/PostDetailModal.tsx`
- `src/app/components/CreatePostModal.tsx`
- `src/app/components/EditPostModal.tsx`
- `src/app/components/FileUploadModal.tsx`
- `src/app/contexts/DataContext.tsx`
- `src/app/contexts/AuthContext.tsx`
- `src/lib/firebase/types.ts`
- `src/lib/firebase/firestore.service.ts`
- `src/lib/firebase/auth.service.ts`
- `functions/src/shared/paths.ts`

---

## Done 체크리스트

- [x] μATOM-0101: invite 키워드(코드 영역) 0건
- [x] μATOM-0102: ApprovalPendingPage/승인 UI 진입 경로 0
- [x] μATOM-0103: GameRecordPage 및 관련 컴포넌트 참조 0
- [x] μATOM-0104: FinancePage/재무 메뉴/총무 role 의존 제거
- [x] μATOM-0105: 앨범 탭/페이지/작성 플로우 0
- [x] μATOM-0106: poll 관련 컴포넌트/탭/타입 0
- [x] μATOM-0107: 제외 도메인 write 허용 0
- [x] μATOM-0108: index.ts 기준 제외 도메인 export 0
- [x] μATOM-0109: 앱에서 제외 도메인으로 들어갈 경로 0
- [ ] μATOM-0110: 코드 기준 0건 (문서/주석 제외) - 부분 완료

---

## 다음 단계 제안

1. **μATOM-0110 완료**: 남아있는 dead code 최종 정리
   - `src/lib/firebase/storage.service.ts`: uploadAlbumMedia 함수 제거
   - `src/app/pages/SchedulePage.tsx`: recorders 관련 코드 검토

2. **P2 단계 시작**: v1.1 IA 재구성 (μATOM-R02)
   - BottomTab 단순화 확인
   - 게시판 탭 3개만 남김 확인

---

## 참고사항

- 모든 제거 작업은 "참조까지 끊기" 원칙 준수
- 빌드 통과 확인 완료
- 타입 에러 없음
- 남아있는 키워드는 대부분 문서/주석/예시 코드임

